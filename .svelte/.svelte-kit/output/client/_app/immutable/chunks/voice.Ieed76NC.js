import{s as J,n as I,r as ye,o as Ce,b as A,a as M}from"./scheduler.H2eWdqud.js";import{S as W,i as Y,e as y,s as x,f as C,x as N,j as P,g as H,r as b,k as p,l as L,z as w,o as Z,v as fe,w as je,y as ke,A as Ae,d as U,q as k,B,p as R,t as O,c as z,b as D,a as F,h as ue,n as K,u as G}from"./index.cgrtaUxB.js";import{Peer as Oe}from"https://esm.sh/peerjs@1.5.2?bundle-deps";function Q(i){return i?.length!==void 0?i:Array.from(i)}function De(i){let e,n,s='<img src="https://static.wikia.nocookie.net/worldtrigger/images/c/c4/Ko_88.png/revision/latest?cb=20211024225357" class="rounded-circle mr-1 incoming-img" alt="" width="220" height="220"/>',r,a,f,c="Answer",l,o,t="Decline",u,h;return{c(){e=y("div"),n=y("div"),n.innerHTML=s,r=x(),a=y("div"),f=y("button"),f.textContent=c,l=x(),o=y("button"),o.textContent=t,this.h()},l(d){e=C(d,"DIV",{class:!0});var _=N(e);n=C(_,"DIV",{class:!0,"data-svelte-h":!0}),P(n)!=="svelte-1kyomsk"&&(n.innerHTML=s),r=H(_),a=C(_,"DIV",{class:!0});var j=N(a);f=C(j,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),P(f)!=="svelte-u7x4sh"&&(f.textContent=c),l=H(j),o=C(j,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),P(o)!=="svelte-1da1e5r"&&(o.textContent=t),j.forEach(b),_.forEach(b),this.h()},h(){p(n,"class","image-container"),p(f,"type","button"),p(f,"class","btn btn-success"),p(o,"type","button"),p(o,"class","btn btn-danger"),p(a,"class","button-area svelte-19roec1"),p(e,"class","incoming-call-container svelte-19roec1")},m(d,_){L(d,e,_),w(e,n),w(e,r),w(e,a),w(a,f),w(a,l),w(a,o),u||(h=[Z(f,"click",i[3]),Z(o,"click",i[4])],u=!0)},p:I,i:I,o:I,d(d){d&&b(e),u=!1,ye(h)}}}function Ne(i,e,n){let{callerUserName:s=""}=e,{Answer:r=(l="")=>{}}=e,{Decline:a=(l="")=>{}}=e;const f=()=>{r(s)},c=()=>{a(s)};return i.$$set=l=>{"callerUserName"in l&&n(0,s=l.callerUserName),"Answer"in l&&n(1,r=l.Answer),"Decline"in l&&n(2,a=l.Decline)},[s,r,a,f,c]}class te extends W{constructor(e){super(),Y(this,e,Ne,De,J,{callerUserName:0,Answer:1,Decline:2})}}class he{constructor(){this.participants=[]}participants=[]}function ne(i,e,n){const s=i.slice();return s[4]=e[n],s}function ae(i){let e,n,s='<img src="https://static.wikia.nocookie.net/worldtrigger/images/c/c4/Ko_88.png/revision/latest?cb=20211024225357" class="rounded-circle mr-1 incoming-img" alt="" width="220" height="220"/>',r,a,f=i[4].username+"",c;return{c(){e=y("div"),n=y("div"),n.innerHTML=s,r=x(),a=y("h3"),c=je(f),this.h()},l(l){e=C(l,"DIV",{class:!0});var o=N(e);n=C(o,"DIV",{class:!0,"data-svelte-h":!0}),P(n)!=="svelte-dx85es"&&(n.innerHTML=s),r=H(o),a=C(o,"H3",{});var t=N(a);c=ke(t,f),t.forEach(b),o.forEach(b),this.h()},h(){p(n,"class","image-container"),p(e,"class","caller-display svelte-1npf0lm")},m(l,o){L(l,e,o),w(e,n),w(e,r),w(e,a),w(a,c)},p(l,o){o&1&&f!==(f=l[4].username+"")&&Ae(c,f)},d(l){l&&b(e)}}}function Le(i){let e,n,s,r,a,f="Leave",c,l,o=Q(i[0].participants),t=[];for(let u=0;u<o.length;u+=1)t[u]=ae(ne(i,o,u));return{c(){e=y("div"),n=y("div");for(let u=0;u<t.length;u+=1)t[u].c();s=x(),r=y("div"),a=y("button"),a.textContent=f,this.h()},l(u){e=C(u,"DIV",{class:!0});var h=N(e);n=C(h,"DIV",{class:!0});var d=N(n);for(let j=0;j<t.length;j+=1)t[j].l(d);s=H(d),r=C(d,"DIV",{class:!0});var _=N(r);a=C(_,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),P(a)!=="svelte-z739lv"&&(a.textContent=f),_.forEach(b),d.forEach(b),h.forEach(b),this.h()},h(){p(a,"type","button"),p(a,"class","btn btn-danger"),p(r,"class","button-area svelte-1npf0lm"),p(n,"class","call-view-container svelte-1npf0lm"),p(e,"class","call-view svelte-1npf0lm")},m(u,h){L(u,e,h),w(e,n);for(let d=0;d<t.length;d+=1)t[d]&&t[d].m(n,null);w(n,s),w(n,r),w(r,a),c||(l=Z(a,"click",i[3]),c=!0)},p(u,[h]){if(h&1){o=Q(u[0].participants);let d;for(d=0;d<o.length;d+=1){const _=ne(u,o,d);t[d]?t[d].p(_,h):(t[d]=ae(_),t[d].c(),t[d].m(n,s))}for(;d<t.length;d+=1)t[d].d(1);t.length=o.length}},i:I,o:I,d(u){u&&b(e),fe(t,u),c=!1,l()}}}function Ee(i,e,n){let{calldata:s=new he}=e;s.participants.push({username:"hgfyhgjgh"}),s.participants.push({username:"hgfyhgjgh"}),s.participants.push({username:"hgfyhgjgh"}),s.participants.push({username:"hgfyhgjgh"}),s.participants.push({username:"hgfyhgjgh"}),s.participants.push({username:"hgfyhgjgh"}),s.participants.push({username:"hgfyhgjgh"});let{callerUserName:r=""}=e,{LeaveCall:a=(c="")=>{}}=e;const f=()=>{a(r)};return i.$$set=c=>{"calldata"in c&&n(0,s=c.calldata),"callerUserName"in c&&n(1,r=c.callerUserName),"LeaveCall"in c&&n(2,a=c.LeaveCall)},[s,r,a,f]}class le extends W{constructor(e){super(),Y(this,e,Ee,Le,J,{calldata:0,callerUserName:1,LeaveCall:2})}}/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var re=Object.getOwnPropertySymbols,Te=Object.prototype.hasOwnProperty,Ue=Object.prototype.propertyIsEnumerable;function Ve(i){if(i==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(i)}function Ie(){try{if(!Object.assign)return!1;var i=new String("abc");if(i[5]="de",Object.getOwnPropertyNames(i)[0]==="5")return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;var s=Object.getOwnPropertyNames(e).map(function(a){return e[a]});if(s.join("")!=="0123456789")return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach(function(a){r[a]=a}),Object.keys(Object.assign({},r)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}Ie();var de={exports:{}};/*!
 * vary
 * Copyright(c) 2014-2017 Douglas Christopher Wilson
 * MIT Licensed
 */de.exports=xe;de.exports.append=ge;var Pe=/^[!#$%&'*+\-.^_`|~0-9A-Za-z]+$/;function ge(i,e){if(typeof i!="string")throw new TypeError("header argument is required");if(!e)throw new TypeError("field argument is required");for(var n=Array.isArray(e)?e:ie(String(e)),s=0;s<n.length;s++)if(!Pe.test(n[s]))throw new TypeError("field argument contains an invalid header name");if(i==="*")return i;var r=i,a=ie(i.toLowerCase());if(n.indexOf("*")!==-1||a.indexOf("*")!==-1)return"*";for(var f=0;f<n.length;f++){var c=n[f].toLowerCase();a.indexOf(c)===-1&&(a.push(c),r=r?r+", "+n[f]:n[f])}return r}function ie(i){for(var e=0,n=[],s=0,r=0,a=i.length;r<a;r++)switch(i.charCodeAt(r)){case 32:s===e&&(s=e=r+1);break;case 44:n.push(i.substring(s,e)),s=e=r+1;break;default:e=r+1;break}return n.push(i.substring(s,e)),n}function xe(i,e){if(!i||!i.getHeader||!i.setHeader)throw new TypeError("res argument is required");var n=i.getHeader("Vary")||"",s=Array.isArray(n)?n.join(", "):String(n);(n=ge(s,e))&&i.setHeader("Vary",n)}function se(i,e,n){const s=i.slice();return s[19]=e[n],s}function ce(i){let e,n,s,r,a;function f(t){i[9](t)}function c(t){i[10](t)}var l=te;function o(t,u){let h={callerUserName:t[19]};return t[2]!==void 0&&(h.Answer=t[2]),t[3]!==void 0&&(h.Decline=t[3]),{props:h}}return l&&(e=z(l,o(i)),A.push(()=>D(e,"Answer",f)),A.push(()=>D(e,"Decline",c))),{c(){e&&F(e.$$.fragment),r=U()},l(t){e&&ue(e.$$.fragment,t),r=U()},m(t,u){e&&K(e,t,u),L(t,r,u),a=!0},p(t,u){if(l!==(l=te)){if(e){B();const h=e;O(h.$$.fragment,1,0,()=>{G(h,1)}),R()}l?(e=z(l,o(t)),A.push(()=>D(e,"Answer",f)),A.push(()=>D(e,"Decline",c)),F(e.$$.fragment),k(e.$$.fragment,1),K(e,r.parentNode,r)):e=null}else if(l){const h={};u&1&&(h.callerUserName=t[19]),!n&&u&4&&(n=!0,h.Answer=t[2],M(()=>n=!1)),!s&&u&8&&(s=!0,h.Decline=t[3],M(()=>s=!1)),e.$set(h)}},i(t){a||(e&&k(e.$$.fragment,t),a=!0)},o(t){e&&O(e.$$.fragment,t),a=!1},d(t){t&&b(r),e&&G(e,t)}}}function oe(i){let e,n,s,r,a;function f(t){i[11](t)}function c(t){i[12](t)}var l=le;function o(t,u){let h={};return t[1]!==void 0&&(h.calldata=t[1]),t[4]!==void 0&&(h.LeaveCall=t[4]),{props:h}}return l&&(e=z(l,o(i)),A.push(()=>D(e,"calldata",f)),A.push(()=>D(e,"LeaveCall",c))),{c(){e&&F(e.$$.fragment),r=U()},l(t){e&&ue(e.$$.fragment,t),r=U()},m(t,u){e&&K(e,t,u),L(t,r,u),a=!0},p(t,u){if(l!==(l=le)){if(e){B();const h=e;O(h.$$.fragment,1,0,()=>{G(h,1)}),R()}l?(e=z(l,o(t)),A.push(()=>D(e,"calldata",f)),A.push(()=>D(e,"LeaveCall",c)),F(e.$$.fragment),k(e.$$.fragment,1),K(e,r.parentNode,r)):e=null}else if(l){const h={};!n&&u&2&&(n=!0,h.calldata=t[1],M(()=>n=!1)),!s&&u&16&&(s=!0,h.LeaveCall=t[4],M(()=>s=!1)),e.$set(h)}},i(t){a||(e&&k(e.$$.fragment,t),a=!0)},o(t){e&&O(e.$$.fragment,t),a=!1},d(t){t&&b(r),e&&G(e,t)}}}function He(i){let e,n,s,r=Q(i[0]),a=[];for(let l=0;l<r.length;l+=1)a[l]=ce(se(i,r,l));const f=l=>O(a[l],1,1,()=>{a[l]=null});let c=i[5]&&oe(i);return{c(){for(let l=0;l<a.length;l+=1)a[l].c();e=x(),c&&c.c(),n=U()},l(l){for(let o=0;o<a.length;o+=1)a[o].l(l);e=H(l),c&&c.l(l),n=U()},m(l,o){for(let t=0;t<a.length;t+=1)a[t]&&a[t].m(l,o);L(l,e,o),c&&c.m(l,o),L(l,n,o),s=!0},p(l,[o]){if(o&13){r=Q(l[0]);let t;for(t=0;t<r.length;t+=1){const u=se(l,r,t);a[t]?(a[t].p(u,o),k(a[t],1)):(a[t]=ce(u),a[t].c(),k(a[t],1),a[t].m(e.parentNode,e))}for(B(),t=r.length;t<a.length;t+=1)f(t);R()}l[5]?c?(c.p(l,o),o&32&&k(c,1)):(c=oe(l),c.c(),k(c,1),c.m(n.parentNode,n)):c&&(B(),O(c,1,1,()=>{c=null}),R())},i(l){if(!s){for(let o=0;o<r.length;o+=1)k(a[o]);k(c),s=!0}},o(l){a=a.filter(Boolean);for(let o=0;o<a.length;o+=1)O(a[o]);O(c),s=!1},d(l){l&&(b(e),b(n)),fe(a,l),c&&c.d(l)}}}function Se(i,e,n){let{val:s="hjbhjkhkjkjhkjhjklhkljklhjkl"}=e,{incomingCalls:r=["jkkjl;llllllll"]}=e,a={};const f=new CustomEvent("event");let{calldata:c=new he}=e,l=!1;var o=io("/",{}),t;const u=(g="")=>{var E={userToCall:g,peerId:t.id};o.emit("call",E)};let{Answer:h=(g="")=>{var E={otherUser:g,peerId:t.id};o.emit("answer-call",E)}}=e,{Reject:d=(g="")=>{var E={otherUser:g};o.emit("reject-call",E)}}=e,{LeaveCall:_=()=>{var g={};o.emit("leave-call",g)}}=e;var j=[];Ce(async()=>{g();function g(E){const T=io("/");t=new Oe(void 0,{});const X={};new Audio,navigator.mediaDevices.getUserMedia({audio:!0}).then(m=>{t.on("call",v=>{v.answer(m);const V=new Audio;v.on("stream",q=>{ee(V,q)})}),t.on("error",function(v){console.log(v)}),T.on("user-connected",v=>{console.log("connecting to other user - "+v),we(v,m)})}).catch(m=>{console.log(m)}),T.on("user-disconnected",m=>{X[m]&&X[m].close()}),t.on("open",m=>{console.log("myid - "+m)});function we(m,v){if(m==t.id)return;const V=t.call(m,v),q=new Audio;V.on("stream",be=>{ee(q,be)}),V.on("close",()=>{q.remove()}),X[m]=V}function ee(m,v){m.srcObject=v,m.addEventListener("loadedmetadata",()=>{m.play()})}T.on("incomingcalls-update",function(m){n(0,r=m.incomingCalls),m.incomingCalls.forEach(v=>{r.includes(v)?a.hasOwnProperty(v)&&(a[v]=Date.now()):(r.push(v),n(0,r),a.hasOwnProperty(v)||(a[v]=Date.now(),setInterval(()=>{console.log(Date.now()-a[v])},5e3)))})}),T.on("message",function(m){console.log(m)}),T.on("call-data",function(m){n(1,c=m),c!=null?(n(5,l=!0),n(0,r=[])):n(5,l=!1)}),T.on("connect_error",m=>{console.log(`connect_error due to ${m.message}`)})}});var S=!0;setInterval(function(){S&&$()},100);function $(){if(S&&j.length!=0){let g=new Audio(j.splice(0,1)[0]);g.addEventListener("ended",function(){S=!0,$()},!1),g.play(),S=!1}}function me(g){h=g,n(2,h)}function ve(g){d=g,n(3,d)}function _e(g){c=g,n(1,c)}function pe(g){_=g,n(4,_)}return i.$$set=g=>{"val"in g&&n(6,s=g.val),"incomingCalls"in g&&n(0,r=g.incomingCalls),"calldata"in g&&n(1,c=g.calldata),"Answer"in g&&n(2,h=g.Answer),"Reject"in g&&n(3,d=g.Reject),"LeaveCall"in g&&n(4,_=g.LeaveCall)},[r,c,h,d,_,l,s,f,u,me,ve,_e,pe]}class Re extends W{constructor(e){super(),Y(this,e,Se,He,J,{val:6,incomingCalls:0,event:7,calldata:1,Call:8,Answer:2,Reject:3,LeaveCall:4})}get event(){return this.$$.ctx[7]}get Call(){return this.$$.ctx[8]}}export{Re as V,Q as e};
