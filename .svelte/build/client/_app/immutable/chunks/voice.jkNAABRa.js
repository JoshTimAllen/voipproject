import{s as W,n as q,r as ye,o as Ce,b as O,a as B}from"./scheduler.H2eWdqud.js";import{S as Y,i as $,e as y,s as S,f as C,x as L,j as H,g as x,r as b,k as p,l as T,z as w,o as J,v as fe,w as je,y as ke,A as Ae,d as I,q as k,B as R,p as z,t as D,c as F,b as N,a as K,h as ue,n as G,u as Q}from"./index.cgrtaUxB.js";import{Peer as Oe}from"https://esm.sh/peerjs@1.5.2?bundle-deps";function X(c){return c?.length!==void 0?c:Array.from(c)}function De(c){let e,n,s,r='<img src="https://static.wikia.nocookie.net/worldtrigger/images/c/c4/Ko_88.png/revision/latest?cb=20211024225357" class="rounded-circle mr-1 incoming-img" alt="" width="220" height="220"/>',a,f,i,l="Answer",o,t,u="Decline",h,g;return{c(){e=y("div"),n=y("div"),s=y("div"),s.innerHTML=r,a=S(),f=y("div"),i=y("button"),i.textContent=l,o=S(),t=y("button"),t.textContent=u,this.h()},l(_){e=C(_,"DIV",{class:!0});var j=L(e);n=C(j,"DIV",{class:!0});var A=L(n);s=C(A,"DIV",{class:!0,"data-svelte-h":!0}),H(s)!=="svelte-1ul5uuc"&&(s.innerHTML=r),a=x(A),f=C(A,"DIV",{class:!0});var E=L(f);i=C(E,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),H(i)!=="svelte-ep4dj5"&&(i.textContent=l),o=x(E),t=C(E,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),H(t)!=="svelte-tc44bz"&&(t.textContent=u),E.forEach(b),A.forEach(b),j.forEach(b),this.h()},h(){p(s,"class","image-container"),p(i,"type","button"),p(i,"class","btn btn-success"),p(t,"type","button"),p(t,"class","btn btn-danger"),p(f,"class","button-area svelte-1r4yqv6"),p(n,"class","incoming-call-container svelte-1r4yqv6"),p(e,"class","incoming-call svelte-1r4yqv6")},m(_,j){T(_,e,j),w(e,n),w(n,s),w(n,a),w(n,f),w(f,i),w(f,o),w(f,t),h||(g=[J(i,"click",c[3]),J(t,"click",c[4])],h=!0)},p:q,i:q,o:q,d(_){_&&b(e),h=!1,ye(g)}}}function Ne(c,e,n){let{callerUserName:s=""}=e,{Answer:r=(l="")=>{}}=e,{Decline:a=(l="")=>{}}=e;const f=()=>{r(s)},i=()=>{a(s)};return c.$$set=l=>{"callerUserName"in l&&n(0,s=l.callerUserName),"Answer"in l&&n(1,r=l.Answer),"Decline"in l&&n(2,a=l.Decline)},[s,r,a,f,i]}class te extends Y{constructor(e){super(),$(this,e,Ne,De,W,{callerUserName:0,Answer:1,Decline:2})}}class he{constructor(){this.participants=[]}participants=[]}function ne(c,e,n){const s=c.slice();return s[4]=e[n],s}function ae(c){let e,n,s='<img src="https://static.wikia.nocookie.net/worldtrigger/images/c/c4/Ko_88.png/revision/latest?cb=20211024225357" class="rounded-circle mr-1 incoming-img" alt="" width="220" height="220"/>',r,a,f=c[4].username+"",i;return{c(){e=y("div"),n=y("div"),n.innerHTML=s,r=S(),a=y("h3"),i=je(f),this.h()},l(l){e=C(l,"DIV",{class:!0});var o=L(e);n=C(o,"DIV",{class:!0,"data-svelte-h":!0}),H(n)!=="svelte-dx85es"&&(n.innerHTML=s),r=x(o),a=C(o,"H3",{});var t=L(a);i=ke(t,f),t.forEach(b),o.forEach(b),this.h()},h(){p(n,"class","image-container"),p(e,"class","caller-display svelte-1npf0lm")},m(l,o){T(l,e,o),w(e,n),w(e,r),w(e,a),w(a,i)},p(l,o){o&1&&f!==(f=l[4].username+"")&&Ae(i,f)},d(l){l&&b(e)}}}function Le(c){let e,n,s,r,a,f="Leave",i,l,o=X(c[0].participants),t=[];for(let u=0;u<o.length;u+=1)t[u]=ae(ne(c,o,u));return{c(){e=y("div"),n=y("div");for(let u=0;u<t.length;u+=1)t[u].c();s=S(),r=y("div"),a=y("button"),a.textContent=f,this.h()},l(u){e=C(u,"DIV",{class:!0});var h=L(e);n=C(h,"DIV",{class:!0});var g=L(n);for(let j=0;j<t.length;j+=1)t[j].l(g);s=x(g),r=C(g,"DIV",{class:!0});var _=L(r);a=C(_,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),H(a)!=="svelte-z739lv"&&(a.textContent=f),_.forEach(b),g.forEach(b),h.forEach(b),this.h()},h(){p(a,"type","button"),p(a,"class","btn btn-danger"),p(r,"class","button-area svelte-1npf0lm"),p(n,"class","call-view-container svelte-1npf0lm"),p(e,"class","call-view svelte-1npf0lm")},m(u,h){T(u,e,h),w(e,n);for(let g=0;g<t.length;g+=1)t[g]&&t[g].m(n,null);w(n,s),w(n,r),w(r,a),i||(l=J(a,"click",c[3]),i=!0)},p(u,[h]){if(h&1){o=X(u[0].participants);let g;for(g=0;g<o.length;g+=1){const _=ne(u,o,g);t[g]?t[g].p(_,h):(t[g]=ae(_),t[g].c(),t[g].m(n,s))}for(;g<t.length;g+=1)t[g].d(1);t.length=o.length}},i:q,o:q,d(u){u&&b(e),fe(t,u),i=!1,l()}}}function Ee(c,e,n){let{calldata:s=new he}=e;s.participants.push({username:"hgfyhgjgh"}),s.participants.push({username:"hgfyhgjgh"}),s.participants.push({username:"hgfyhgjgh"}),s.participants.push({username:"hgfyhgjgh"}),s.participants.push({username:"hgfyhgjgh"}),s.participants.push({username:"hgfyhgjgh"}),s.participants.push({username:"hgfyhgjgh"});let{callerUserName:r=""}=e,{LeaveCall:a=(i="")=>{}}=e;const f=()=>{a(r)};return c.$$set=i=>{"calldata"in i&&n(0,s=i.calldata),"callerUserName"in i&&n(1,r=i.callerUserName),"LeaveCall"in i&&n(2,a=i.LeaveCall)},[s,r,a,f]}class le extends Y{constructor(e){super(),$(this,e,Ee,Le,W,{calldata:0,callerUserName:1,LeaveCall:2})}}/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var re=Object.getOwnPropertySymbols,Te=Object.prototype.hasOwnProperty,Ue=Object.prototype.propertyIsEnumerable;function Ve(c){if(c==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(c)}function Ie(){try{if(!Object.assign)return!1;var c=new String("abc");if(c[5]="de",Object.getOwnPropertyNames(c)[0]==="5")return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;var s=Object.getOwnPropertyNames(e).map(function(a){return e[a]});if(s.join("")!=="0123456789")return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach(function(a){r[a]=a}),Object.keys(Object.assign({},r)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}Ie();var de={exports:{}};/*!
 * vary
 * Copyright(c) 2014-2017 Douglas Christopher Wilson
 * MIT Licensed
 */de.exports=qe;de.exports.append=ge;var Pe=/^[!#$%&'*+\-.^_`|~0-9A-Za-z]+$/;function ge(c,e){if(typeof c!="string")throw new TypeError("header argument is required");if(!e)throw new TypeError("field argument is required");for(var n=Array.isArray(e)?e:ie(String(e)),s=0;s<n.length;s++)if(!Pe.test(n[s]))throw new TypeError("field argument contains an invalid header name");if(c==="*")return c;var r=c,a=ie(c.toLowerCase());if(n.indexOf("*")!==-1||a.indexOf("*")!==-1)return"*";for(var f=0;f<n.length;f++){var i=n[f].toLowerCase();a.indexOf(i)===-1&&(a.push(i),r=r?r+", "+n[f]:n[f])}return r}function ie(c){for(var e=0,n=[],s=0,r=0,a=c.length;r<a;r++)switch(c.charCodeAt(r)){case 32:s===e&&(s=e=r+1);break;case 44:n.push(c.substring(s,e)),s=e=r+1;break;default:e=r+1;break}return n.push(c.substring(s,e)),n}function qe(c,e){if(!c||!c.getHeader||!c.setHeader)throw new TypeError("res argument is required");var n=c.getHeader("Vary")||"",s=Array.isArray(n)?n.join(", "):String(n);(n=ge(s,e))&&c.setHeader("Vary",n)}function se(c,e,n){const s=c.slice();return s[19]=e[n],s}function ce(c){let e,n,s,r,a;function f(t){c[9](t)}function i(t){c[10](t)}var l=te;function o(t,u){let h={callerUserName:t[19]};return t[2]!==void 0&&(h.Answer=t[2]),t[3]!==void 0&&(h.Decline=t[3]),{props:h}}return l&&(e=F(l,o(c)),O.push(()=>N(e,"Answer",f)),O.push(()=>N(e,"Decline",i))),{c(){e&&K(e.$$.fragment),r=I()},l(t){e&&ue(e.$$.fragment,t),r=I()},m(t,u){e&&G(e,t,u),T(t,r,u),a=!0},p(t,u){if(l!==(l=te)){if(e){R();const h=e;D(h.$$.fragment,1,0,()=>{Q(h,1)}),z()}l?(e=F(l,o(t)),O.push(()=>N(e,"Answer",f)),O.push(()=>N(e,"Decline",i)),K(e.$$.fragment),k(e.$$.fragment,1),G(e,r.parentNode,r)):e=null}else if(l){const h={};u&1&&(h.callerUserName=t[19]),!n&&u&4&&(n=!0,h.Answer=t[2],B(()=>n=!1)),!s&&u&8&&(s=!0,h.Decline=t[3],B(()=>s=!1)),e.$set(h)}},i(t){a||(e&&k(e.$$.fragment,t),a=!0)},o(t){e&&D(e.$$.fragment,t),a=!1},d(t){t&&b(r),e&&Q(e,t)}}}function oe(c){let e,n,s,r,a;function f(t){c[11](t)}function i(t){c[12](t)}var l=le;function o(t,u){let h={};return t[1]!==void 0&&(h.calldata=t[1]),t[4]!==void 0&&(h.LeaveCall=t[4]),{props:h}}return l&&(e=F(l,o(c)),O.push(()=>N(e,"calldata",f)),O.push(()=>N(e,"LeaveCall",i))),{c(){e&&K(e.$$.fragment),r=I()},l(t){e&&ue(e.$$.fragment,t),r=I()},m(t,u){e&&G(e,t,u),T(t,r,u),a=!0},p(t,u){if(l!==(l=le)){if(e){R();const h=e;D(h.$$.fragment,1,0,()=>{Q(h,1)}),z()}l?(e=F(l,o(t)),O.push(()=>N(e,"calldata",f)),O.push(()=>N(e,"LeaveCall",i)),K(e.$$.fragment),k(e.$$.fragment,1),G(e,r.parentNode,r)):e=null}else if(l){const h={};!n&&u&2&&(n=!0,h.calldata=t[1],B(()=>n=!1)),!s&&u&16&&(s=!0,h.LeaveCall=t[4],B(()=>s=!1)),e.$set(h)}},i(t){a||(e&&k(e.$$.fragment,t),a=!0)},o(t){e&&D(e.$$.fragment,t),a=!1},d(t){t&&b(r),e&&Q(e,t)}}}function He(c){let e,n,s,r=X(c[0]),a=[];for(let l=0;l<r.length;l+=1)a[l]=ce(se(c,r,l));const f=l=>D(a[l],1,1,()=>{a[l]=null});let i=c[5]&&oe(c);return{c(){for(let l=0;l<a.length;l+=1)a[l].c();e=S(),i&&i.c(),n=I()},l(l){for(let o=0;o<a.length;o+=1)a[o].l(l);e=x(l),i&&i.l(l),n=I()},m(l,o){for(let t=0;t<a.length;t+=1)a[t]&&a[t].m(l,o);T(l,e,o),i&&i.m(l,o),T(l,n,o),s=!0},p(l,[o]){if(o&13){r=X(l[0]);let t;for(t=0;t<r.length;t+=1){const u=se(l,r,t);a[t]?(a[t].p(u,o),k(a[t],1)):(a[t]=ce(u),a[t].c(),k(a[t],1),a[t].m(e.parentNode,e))}for(R(),t=r.length;t<a.length;t+=1)f(t);z()}l[5]?i?(i.p(l,o),o&32&&k(i,1)):(i=oe(l),i.c(),k(i,1),i.m(n.parentNode,n)):i&&(R(),D(i,1,1,()=>{i=null}),z())},i(l){if(!s){for(let o=0;o<r.length;o+=1)k(a[o]);k(i),s=!0}},o(l){a=a.filter(Boolean);for(let o=0;o<a.length;o+=1)D(a[o]);D(i),s=!1},d(l){l&&(b(e),b(n)),fe(a,l),i&&i.d(l)}}}function Se(c,e,n){let{val:s="hjbhjkhkjkjhkjhjklhkljklhjkl"}=e,{incomingCalls:r=["jkkjl;llllllll"]}=e,a={};const f=new CustomEvent("event");let{calldata:i=new he}=e,l=!1;var o=io("/",{}),t;const u=(d="")=>{var U={userToCall:d,peerId:t.id};o.emit("call",U)};let{Answer:h=(d="")=>{var U={otherUser:d,peerId:t.id};o.emit("answer-call",U)}}=e,{Reject:g=(d="")=>{var U={otherUser:d};o.emit("reject-call",U)}}=e,{LeaveCall:_=()=>{var d={};o.emit("leave-call",d)}}=e;var j=[];Ce(async()=>{d();function d(U){const V=io("/");t=new Oe(void 0,{});const Z={};new Audio,navigator.mediaDevices.getUserMedia({audio:!0}).then(m=>{t.on("call",v=>{v.answer(m);const P=new Audio;v.on("stream",M=>{ee(P,M)})}),t.on("error",function(v){console.log(v)}),V.on("user-connected",v=>{console.log("connecting to other user - "+v),we(v,m)})}).catch(m=>{console.log(m)}),V.on("user-disconnected",m=>{Z[m]&&Z[m].close()}),t.on("open",m=>{console.log("myid - "+m)});function we(m,v){if(m==t.id)return;const P=t.call(m,v),M=new Audio;P.on("stream",be=>{ee(M,be)}),P.on("close",()=>{M.remove()}),Z[m]=P}function ee(m,v){m.srcObject=v,m.addEventListener("loadedmetadata",()=>{m.play()})}V.on("incomingcalls-update",function(m){n(0,r=m.incomingCalls),m.incomingCalls.forEach(v=>{r.includes(v)?a.hasOwnProperty(v)&&(a[v]=Date.now()):(r.push(v),n(0,r),a.hasOwnProperty(v)||(a[v]=Date.now(),setInterval(()=>{console.log(Date.now()-a[v])},5e3)))})}),V.on("message",function(m){console.log(m)}),V.on("call-data",function(m){n(1,i=m),i!=null?(n(5,l=!0),n(0,r=[])):n(5,l=!1)}),V.on("connect_error",m=>{console.log(`connect_error due to ${m.message}`)})}});var A=!0;setInterval(function(){A&&E()},100);function E(){if(A&&j.length!=0){let d=new Audio(j.splice(0,1)[0]);d.addEventListener("ended",function(){A=!0,E()},!1),d.play(),A=!1}}function me(d){h=d,n(2,h)}function ve(d){g=d,n(3,g)}function _e(d){i=d,n(1,i)}function pe(d){_=d,n(4,_)}return c.$$set=d=>{"val"in d&&n(6,s=d.val),"incomingCalls"in d&&n(0,r=d.incomingCalls),"calldata"in d&&n(1,i=d.calldata),"Answer"in d&&n(2,h=d.Answer),"Reject"in d&&n(3,g=d.Reject),"LeaveCall"in d&&n(4,_=d.LeaveCall)},[r,i,h,g,_,l,s,f,u,me,ve,_e,pe]}class Re extends Y{constructor(e){super(),$(this,e,Se,He,W,{val:6,incomingCalls:0,event:7,calldata:1,Call:8,Answer:2,Reject:3,LeaveCall:4})}get event(){return this.$$.ctx[7]}get Call(){return this.$$.ctx[8]}}export{Re as V,X as e};
